{"ast":null,"code":"import React from 'react';\nimport { createAssistant, createSmartappDebugger } from '@salutejs/client';\nimport './App.css';\nimport { TaskList } from './pages/TaskList';\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst initializeAssistant = (getState /*: any*/, getRecoveryState) => {\n  if (process.env.NODE_ENV === 'development') {\n    var _process$env$REACT_AP;\n    return createSmartappDebugger({\n      token: (_process$env$REACT_AP = process.env.REACT_APP_TOKEN) !== null && _process$env$REACT_AP !== void 0 ? _process$env$REACT_AP : '',\n      initPhrase: `Запусти ${process.env.REACT_APP_SMARTAPP}`,\n      getState,\n      // getRecoveryState: getState,                                           \n      nativePanel: {\n        defaultText: 'ччччччч',\n        screenshotMode: false,\n        tabIndex: -1\n      }\n    });\n  } else {\n    return createAssistant({\n      getState\n    });\n  }\n};\nexport class App extends React.Component {\n  constructor(props) {\n    super(props);\n    console.log('constructor');\n    this.state = {\n      notes: [{\n        id: Math.random().toString(36).substring(7),\n        title: 'тест'\n      }]\n    };\n    this.assistant = initializeAssistant(() => this.getStateForAssistant());\n    this.assistant.on('data', (event /*: any*/) => {\n      console.log(`assistant.on(data)`, event);\n      if (event.type === 'character') {\n        var _event$character;\n        console.log(`assistant.on(data): character: \"${event === null || event === void 0 ? void 0 : (_event$character = event.character) === null || _event$character === void 0 ? void 0 : _event$character.id}\"`);\n      } else if (event.type === 'insets') {\n        console.log(`assistant.on(data): insets`);\n      } else {\n        const {\n          action\n        } = event;\n        this.dispatchAssistantAction(action);\n      }\n    });\n    this.assistant.on('start', event => {\n      let initialData = this.assistant.getInitialData();\n      console.log(`assistant.on(start)`, event, initialData);\n    });\n    this.assistant.on('command', event => {\n      console.log(`assistant.on(command)`, event);\n    });\n    this.assistant.on('error', event => {\n      console.log(`assistant.on(error)`, event);\n    });\n    this.assistant.on('tts', event => {\n      console.log(`assistant.on(tts)`, event);\n    });\n  }\n  componentDidMount() {\n    console.log('componentDidMount');\n  }\n  getStateForAssistant() {\n    console.log('getStateForAssistant: this.state:', this.state);\n    const state = {\n      item_selector: {\n        items: this.state.notes.map((_ref, index) => {\n          let {\n            id,\n            title\n          } = _ref;\n          return {\n            number: index + 1,\n            id,\n            title\n          };\n        }),\n        ignored_words: ['добавить', 'установить', 'запиши', 'поставь', 'закинь', 'напомнить',\n        // addNote.sc\n        'удалить', 'удали',\n        // deleteNote.sc\n        'выполни', 'выполнил', 'сделал' // выполнил|сделал\n        ]\n      }\n    };\n\n    console.log('getStateForAssistant: state:', state);\n    return state;\n  }\n  dispatchAssistantAction(action) {\n    console.log('dispatchAssistantAction', action);\n    if (action) {\n      switch (action.type) {\n        case 'add_note':\n          return this.add_note(action);\n        case 'done_note':\n          return this.done_note(action);\n        case 'delete_note':\n          return this.delete_note(action);\n        default:\n          throw new Error();\n      }\n    }\n  }\n  add_note(action) {\n    console.log('add_note', action);\n    this.setState({\n      notes: [...this.state.notes, {\n        id: Math.random().toString(36).substring(7),\n        title: action.note,\n        completed: false\n      }]\n    });\n  }\n  done_note(action) {\n    console.log('done_note', action);\n    this.setState({\n      notes: this.state.notes.map(note => note.id === action.id ? {\n        ...note,\n        completed: !note.completed\n      } : note)\n    });\n  }\n  _send_action_value(action_id, value) {\n    const data = {\n      action: {\n        action_id: action_id,\n        parameters: {\n          // значение поля parameters может быть любым, но должно соответствовать серверной логике\n          value: value // см.файл src/sc/noteDone.sc смартаппа в Studio Code\n        }\n      }\n    };\n\n    const unsubscribe = this.assistant.sendData(data, data => {\n      // функция, вызываемая, если на sendData() был отправлен ответ\n      const {\n        type,\n        payload\n      } = data;\n      console.log('sendData onData:', type, payload);\n      unsubscribe();\n    });\n  }\n  play_done_note(id) {\n    var _this$state$notes$fin;\n    const completed = (_this$state$notes$fin = this.state.notes.find(_ref2 => {\n      let {\n        id\n      } = _ref2;\n      return id;\n    })) === null || _this$state$notes$fin === void 0 ? void 0 : _this$state$notes$fin.completed;\n    if (!completed) {\n      const texts = ['Молодец!', 'Красавчик!', 'Супер!'];\n      const idx = Math.random() * texts.length | 0;\n      this._send_action_value('done', texts[idx]);\n    }\n  }\n  delete_note(action) {\n    console.log('delete_note', action);\n    this.setState({\n      notes: this.state.notes.filter(_ref3 => {\n        let {\n          id\n        } = _ref3;\n        return id !== action.id;\n      })\n    });\n  }\n  render() {\n    console.log('render');\n    return /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false);\n  }\n}","map":{"version":3,"names":["React","createAssistant","createSmartappDebugger","TaskList","Fragment","_Fragment","jsxDEV","_jsxDEV","initializeAssistant","getState","getRecoveryState","process","env","NODE_ENV","_process$env$REACT_AP","token","REACT_APP_TOKEN","initPhrase","REACT_APP_SMARTAPP","nativePanel","defaultText","screenshotMode","tabIndex","App","Component","constructor","props","console","log","state","notes","id","Math","random","toString","substring","title","assistant","getStateForAssistant","on","event","type","_event$character","character","action","dispatchAssistantAction","initialData","getInitialData","componentDidMount","item_selector","items","map","_ref","index","number","ignored_words","add_note","done_note","delete_note","Error","setState","note","completed","_send_action_value","action_id","value","data","parameters","unsubscribe","sendData","payload","play_done_note","_this$state$notes$fin","find","_ref2","texts","idx","length","filter","_ref3","render"],"sources":["/Users/egor/Documents/GitHub/SBERProject/src/App.jsx"],"sourcesContent":["import React from 'react';\nimport { createAssistant, createSmartappDebugger } from '@salutejs/client';\n\nimport './App.css';\nimport { TaskList } from './pages/TaskList';\n\nconst initializeAssistant = (getState /*: any*/, getRecoveryState) => {\n  if (process.env.NODE_ENV === 'development') {\n    return createSmartappDebugger({\n      token: process.env.REACT_APP_TOKEN ?? '',\n      initPhrase: `Запусти ${process.env.REACT_APP_SMARTAPP}`,\n      getState,                                           \n      // getRecoveryState: getState,                                           \n      nativePanel: {\n        defaultText: 'ччччччч',\n        screenshotMode: false,\n        tabIndex: -1,\n    },\n    });\n  } else {\n  return createAssistant({ getState });\n  }\n};\n\nexport class App extends React.Component {\n  constructor(props) {\n    super(props);\n    console.log('constructor');\n\n    this.state = {\n      notes: [{ id: Math.random().toString(36).substring(7), title: 'тест' }],\n    };\n\n    this.assistant = initializeAssistant(() => this.getStateForAssistant());\n\n    this.assistant.on('data', (event /*: any*/) => {\n      console.log(`assistant.on(data)`, event);\n      if (event.type === 'character') {\n        console.log(`assistant.on(data): character: \"${event?.character?.id}\"`);\n      } else if (event.type === 'insets') {\n        console.log(`assistant.on(data): insets`);\n      } else {\n        const { action } = event;\n        this.dispatchAssistantAction(action);\n      }\n    });\n\n    this.assistant.on('start', (event) => {\n      let initialData = this.assistant.getInitialData();\n\n      console.log(`assistant.on(start)`, event, initialData);\n    });\n\n    this.assistant.on('command', (event) => {\n      console.log(`assistant.on(command)`, event);\n    });\n\n    this.assistant.on('error', (event) => {\n      console.log(`assistant.on(error)`, event);\n    });\n\n    this.assistant.on('tts', (event) => {\n      console.log(`assistant.on(tts)`, event);\n    });\n  }\n\n  componentDidMount() {\n    console.log('componentDidMount');\n  }\n\n  getStateForAssistant() {\n    console.log('getStateForAssistant: this.state:', this.state);\n    const state = {\n      item_selector: {\n        items: this.state.notes.map(({ id, title }, index) => ({\n          number: index + 1,\n          id,\n          title,\n        })),\n        ignored_words: [\n          'добавить','установить','запиши','поставь','закинь','напомнить', // addNote.sc\n          'удалить', 'удали',  // deleteNote.sc\n          'выполни', 'выполнил', 'сделал' // выполнил|сделал\n        ],\n      },\n    };\n    console.log('getStateForAssistant: state:', state);\n    return state;\n  }\n\n  dispatchAssistantAction(action) {\n    console.log('dispatchAssistantAction', action);\n    if (action) {\n      switch (action.type) {\n        case 'add_note':\n          return this.add_note(action);\n\n        case 'done_note':\n          return this.done_note(action);\n\n        case 'delete_note':\n          return this.delete_note(action);\n\n        default:\n          throw new Error();\n      }\n    }\n  }\n\n  add_note(action) {\n    console.log('add_note', action);\n    this.setState({\n      notes: [\n        ...this.state.notes,\n        {\n          id: Math.random().toString(36).substring(7),\n          title: action.note,\n          completed: false,\n        },\n      ],\n    });\n  }\n\n  done_note(action) {\n    console.log('done_note', action);\n    this.setState({\n      notes: this.state.notes.map((note) =>\n        note.id === action.id ? { ...note, completed: !note.completed } : note\n      ),\n    });\n  }\n\n  _send_action_value(action_id, value) {\n    const data = {\n      action: {\n        action_id: action_id,\n        parameters: {\n          // значение поля parameters может быть любым, но должно соответствовать серверной логике\n          value: value, // см.файл src/sc/noteDone.sc смартаппа в Studio Code\n        },\n      },\n    };\n    const unsubscribe = this.assistant.sendData(data, (data) => {\n      // функция, вызываемая, если на sendData() был отправлен ответ\n      const { type, payload } = data;\n      console.log('sendData onData:', type, payload);\n      unsubscribe();\n    });\n  }\n\n  play_done_note(id) {\n    const completed = this.state.notes.find(({ id }) => id)?.completed;\n    if (!completed) {\n      const texts = ['Молодец!', 'Красавчик!', 'Супер!'];\n      const idx = (Math.random() * texts.length) | 0;\n      this._send_action_value('done', texts[idx]);\n    }\n  }\n\n  delete_note(action) {\n    console.log('delete_note', action);\n    this.setState({\n      notes: this.state.notes.filter(({ id }) => id !== action.id),\n    });\n  }\n\n  render() {\n    console.log('render');\n    return (\n      <>\n        \n      </>\n    );\n  }\n}\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,eAAe,EAAEC,sBAAsB,QAAQ,kBAAkB;AAE1E,OAAO,WAAW;AAClB,SAASC,QAAQ,QAAQ,kBAAkB;AAAC,SAAAC,QAAA,IAAAC,SAAA;AAAA,SAAAC,MAAA,IAAAC,OAAA;AAE5C,MAAMC,mBAAmB,GAAGA,CAACC,QAAQ,CAAC,WAAWC,gBAAgB,KAAK;EACpE,IAAIC,OAAO,CAACC,GAAG,CAACC,QAAQ,KAAK,aAAa,EAAE;IAAA,IAAAC,qBAAA;IAC1C,OAAOZ,sBAAsB,CAAC;MAC5Ba,KAAK,GAAAD,qBAAA,GAAEH,OAAO,CAACC,GAAG,CAACI,eAAe,cAAAF,qBAAA,cAAAA,qBAAA,GAAI,EAAE;MACxCG,UAAU,EAAG,WAAUN,OAAO,CAACC,GAAG,CAACM,kBAAmB,EAAC;MACvDT,QAAQ;MACR;MACAU,WAAW,EAAE;QACXC,WAAW,EAAE,SAAS;QACtBC,cAAc,EAAE,KAAK;QACrBC,QAAQ,EAAE,CAAC;MACf;IACA,CAAC,CAAC;EACJ,CAAC,MAAM;IACP,OAAOrB,eAAe,CAAC;MAAEQ;IAAS,CAAC,CAAC;EACpC;AACF,CAAC;AAED,OAAO,MAAMc,GAAG,SAASvB,KAAK,CAACwB,SAAS,CAAC;EACvCC,WAAWA,CAACC,KAAK,EAAE;IACjB,KAAK,CAACA,KAAK,CAAC;IACZC,OAAO,CAACC,GAAG,CAAC,aAAa,CAAC;IAE1B,IAAI,CAACC,KAAK,GAAG;MACXC,KAAK,EAAE,CAAC;QAAEC,EAAE,EAAEC,IAAI,CAACC,MAAM,CAAC,CAAC,CAACC,QAAQ,CAAC,EAAE,CAAC,CAACC,SAAS,CAAC,CAAC,CAAC;QAAEC,KAAK,EAAE;MAAO,CAAC;IACxE,CAAC;IAED,IAAI,CAACC,SAAS,GAAG7B,mBAAmB,CAAC,MAAM,IAAI,CAAC8B,oBAAoB,CAAC,CAAC,CAAC;IAEvE,IAAI,CAACD,SAAS,CAACE,EAAE,CAAC,MAAM,EAAE,CAACC,KAAK,CAAC,cAAc;MAC7Cb,OAAO,CAACC,GAAG,CAAE,oBAAmB,EAAEY,KAAK,CAAC;MACxC,IAAIA,KAAK,CAACC,IAAI,KAAK,WAAW,EAAE;QAAA,IAAAC,gBAAA;QAC9Bf,OAAO,CAACC,GAAG,CAAE,mCAAkCY,KAAK,aAALA,KAAK,wBAAAE,gBAAA,GAALF,KAAK,CAAEG,SAAS,cAAAD,gBAAA,uBAAhBA,gBAAA,CAAkBX,EAAG,GAAE,CAAC;MACzE,CAAC,MAAM,IAAIS,KAAK,CAACC,IAAI,KAAK,QAAQ,EAAE;QAClCd,OAAO,CAACC,GAAG,CAAE,4BAA2B,CAAC;MAC3C,CAAC,MAAM;QACL,MAAM;UAAEgB;QAAO,CAAC,GAAGJ,KAAK;QACxB,IAAI,CAACK,uBAAuB,CAACD,MAAM,CAAC;MACtC;IACF,CAAC,CAAC;IAEF,IAAI,CAACP,SAAS,CAACE,EAAE,CAAC,OAAO,EAAGC,KAAK,IAAK;MACpC,IAAIM,WAAW,GAAG,IAAI,CAACT,SAAS,CAACU,cAAc,CAAC,CAAC;MAEjDpB,OAAO,CAACC,GAAG,CAAE,qBAAoB,EAAEY,KAAK,EAAEM,WAAW,CAAC;IACxD,CAAC,CAAC;IAEF,IAAI,CAACT,SAAS,CAACE,EAAE,CAAC,SAAS,EAAGC,KAAK,IAAK;MACtCb,OAAO,CAACC,GAAG,CAAE,uBAAsB,EAAEY,KAAK,CAAC;IAC7C,CAAC,CAAC;IAEF,IAAI,CAACH,SAAS,CAACE,EAAE,CAAC,OAAO,EAAGC,KAAK,IAAK;MACpCb,OAAO,CAACC,GAAG,CAAE,qBAAoB,EAAEY,KAAK,CAAC;IAC3C,CAAC,CAAC;IAEF,IAAI,CAACH,SAAS,CAACE,EAAE,CAAC,KAAK,EAAGC,KAAK,IAAK;MAClCb,OAAO,CAACC,GAAG,CAAE,mBAAkB,EAAEY,KAAK,CAAC;IACzC,CAAC,CAAC;EACJ;EAEAQ,iBAAiBA,CAAA,EAAG;IAClBrB,OAAO,CAACC,GAAG,CAAC,mBAAmB,CAAC;EAClC;EAEAU,oBAAoBA,CAAA,EAAG;IACrBX,OAAO,CAACC,GAAG,CAAC,mCAAmC,EAAE,IAAI,CAACC,KAAK,CAAC;IAC5D,MAAMA,KAAK,GAAG;MACZoB,aAAa,EAAE;QACbC,KAAK,EAAE,IAAI,CAACrB,KAAK,CAACC,KAAK,CAACqB,GAAG,CAAC,CAAAC,IAAA,EAAgBC,KAAK;UAAA,IAApB;YAAEtB,EAAE;YAAEK;UAAM,CAAC,GAAAgB,IAAA;UAAA,OAAa;YACrDE,MAAM,EAAED,KAAK,GAAG,CAAC;YACjBtB,EAAE;YACFK;UACF,CAAC;QAAA,CAAC,CAAC;QACHmB,aAAa,EAAE,CACb,UAAU,EAAC,YAAY,EAAC,QAAQ,EAAC,SAAS,EAAC,QAAQ,EAAC,WAAW;QAAE;QACjE,SAAS,EAAE,OAAO;QAAG;QACrB,SAAS,EAAE,UAAU,EAAE,QAAQ,CAAC;QAAA;MAEpC;IACF,CAAC;;IACD5B,OAAO,CAACC,GAAG,CAAC,8BAA8B,EAAEC,KAAK,CAAC;IAClD,OAAOA,KAAK;EACd;EAEAgB,uBAAuBA,CAACD,MAAM,EAAE;IAC9BjB,OAAO,CAACC,GAAG,CAAC,yBAAyB,EAAEgB,MAAM,CAAC;IAC9C,IAAIA,MAAM,EAAE;MACV,QAAQA,MAAM,CAACH,IAAI;QACjB,KAAK,UAAU;UACb,OAAO,IAAI,CAACe,QAAQ,CAACZ,MAAM,CAAC;QAE9B,KAAK,WAAW;UACd,OAAO,IAAI,CAACa,SAAS,CAACb,MAAM,CAAC;QAE/B,KAAK,aAAa;UAChB,OAAO,IAAI,CAACc,WAAW,CAACd,MAAM,CAAC;QAEjC;UACE,MAAM,IAAIe,KAAK,CAAC,CAAC;MACrB;IACF;EACF;EAEAH,QAAQA,CAACZ,MAAM,EAAE;IACfjB,OAAO,CAACC,GAAG,CAAC,UAAU,EAAEgB,MAAM,CAAC;IAC/B,IAAI,CAACgB,QAAQ,CAAC;MACZ9B,KAAK,EAAE,CACL,GAAG,IAAI,CAACD,KAAK,CAACC,KAAK,EACnB;QACEC,EAAE,EAAEC,IAAI,CAACC,MAAM,CAAC,CAAC,CAACC,QAAQ,CAAC,EAAE,CAAC,CAACC,SAAS,CAAC,CAAC,CAAC;QAC3CC,KAAK,EAAEQ,MAAM,CAACiB,IAAI;QAClBC,SAAS,EAAE;MACb,CAAC;IAEL,CAAC,CAAC;EACJ;EAEAL,SAASA,CAACb,MAAM,EAAE;IAChBjB,OAAO,CAACC,GAAG,CAAC,WAAW,EAAEgB,MAAM,CAAC;IAChC,IAAI,CAACgB,QAAQ,CAAC;MACZ9B,KAAK,EAAE,IAAI,CAACD,KAAK,CAACC,KAAK,CAACqB,GAAG,CAAEU,IAAI,IAC/BA,IAAI,CAAC9B,EAAE,KAAKa,MAAM,CAACb,EAAE,GAAG;QAAE,GAAG8B,IAAI;QAAEC,SAAS,EAAE,CAACD,IAAI,CAACC;MAAU,CAAC,GAAGD,IACpE;IACF,CAAC,CAAC;EACJ;EAEAE,kBAAkBA,CAACC,SAAS,EAAEC,KAAK,EAAE;IACnC,MAAMC,IAAI,GAAG;MACXtB,MAAM,EAAE;QACNoB,SAAS,EAAEA,SAAS;QACpBG,UAAU,EAAE;UACV;UACAF,KAAK,EAAEA,KAAK,CAAE;QAChB;MACF;IACF,CAAC;;IACD,MAAMG,WAAW,GAAG,IAAI,CAAC/B,SAAS,CAACgC,QAAQ,CAACH,IAAI,EAAGA,IAAI,IAAK;MAC1D;MACA,MAAM;QAAEzB,IAAI;QAAE6B;MAAQ,CAAC,GAAGJ,IAAI;MAC9BvC,OAAO,CAACC,GAAG,CAAC,kBAAkB,EAAEa,IAAI,EAAE6B,OAAO,CAAC;MAC9CF,WAAW,CAAC,CAAC;IACf,CAAC,CAAC;EACJ;EAEAG,cAAcA,CAACxC,EAAE,EAAE;IAAA,IAAAyC,qBAAA;IACjB,MAAMV,SAAS,IAAAU,qBAAA,GAAG,IAAI,CAAC3C,KAAK,CAACC,KAAK,CAAC2C,IAAI,CAACC,KAAA;MAAA,IAAC;QAAE3C;MAAG,CAAC,GAAA2C,KAAA;MAAA,OAAK3C,EAAE;IAAA,EAAC,cAAAyC,qBAAA,uBAArCA,qBAAA,CAAuCV,SAAS;IAClE,IAAI,CAACA,SAAS,EAAE;MACd,MAAMa,KAAK,GAAG,CAAC,UAAU,EAAE,YAAY,EAAE,QAAQ,CAAC;MAClD,MAAMC,GAAG,GAAI5C,IAAI,CAACC,MAAM,CAAC,CAAC,GAAG0C,KAAK,CAACE,MAAM,GAAI,CAAC;MAC9C,IAAI,CAACd,kBAAkB,CAAC,MAAM,EAAEY,KAAK,CAACC,GAAG,CAAC,CAAC;IAC7C;EACF;EAEAlB,WAAWA,CAACd,MAAM,EAAE;IAClBjB,OAAO,CAACC,GAAG,CAAC,aAAa,EAAEgB,MAAM,CAAC;IAClC,IAAI,CAACgB,QAAQ,CAAC;MACZ9B,KAAK,EAAE,IAAI,CAACD,KAAK,CAACC,KAAK,CAACgD,MAAM,CAACC,KAAA;QAAA,IAAC;UAAEhD;QAAG,CAAC,GAAAgD,KAAA;QAAA,OAAKhD,EAAE,KAAKa,MAAM,CAACb,EAAE;MAAA;IAC7D,CAAC,CAAC;EACJ;EAEAiD,MAAMA,CAAA,EAAG;IACPrD,OAAO,CAACC,GAAG,CAAC,QAAQ,CAAC;IACrB,oBACErB,OAAA,CAAAF,SAAA,mBAEE,CAAC;EAEP;AACF"},"metadata":{},"sourceType":"module","externalDependencies":[]}
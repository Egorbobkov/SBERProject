{"ast":null,"code":"import { e as __spreadArray, a as __rest, _ as __assign, b as __awaiter, f as createNanoObservable, d as createNanoEvents, c as __generator } from './common-ba25e019.js';\n\n// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\nvar getRandomValues;\nvar rnds8 = new Uint8Array(16);\nfunction rng() {\n  // lazy load so that environments that need to polyfill have a chance to do so\n  if (!getRandomValues) {\n    // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation. Also,\n    // find the complete implementation of crypto (msCrypto) on IE11.\n    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto) || typeof msCrypto !== 'undefined' && typeof msCrypto.getRandomValues === 'function' && msCrypto.getRandomValues.bind(msCrypto);\n    if (!getRandomValues) {\n      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n    }\n  }\n  return getRandomValues(rnds8);\n}\nvar REGEX = /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;\nfunction validate(uuid) {\n  return typeof uuid === 'string' && REGEX.test(uuid);\n}\n\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nvar byteToHex = [];\nfor (var i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).substr(1));\n}\nfunction stringify(arr) {\n  var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  var uuid = (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase(); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!validate(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n  return uuid;\n}\nfunction v4(options, buf, offset) {\n  options = options || {};\n  var rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n    for (var i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n    return buf;\n  }\n  return stringify(rnds);\n}\nvar isDeepEqual = function isDeepEqual(a, b) {\n  // Простое значение\n  if (typeof a !== 'object' || a === null) {\n    return a === b;\n  }\n  // Массив\n  if (Array.isArray(a)) {\n    if (!Array.isArray(b) || a.length !== b.length) {\n      return false;\n    }\n    return !a.some(function (valA, key) {\n      return !isDeepEqual(valA, b[key]);\n    });\n  }\n  // Словарь\n  if (typeof b !== 'object' || b === null) {\n    return false;\n  }\n  var entriesA = Object.entries(a);\n  var entriesB = Object.entries(b);\n  if (entriesA.length !== entriesB.length) {\n    return false;\n  }\n  return !entriesA.some(function (_a) {\n    var key = _a[0],\n      valA = _a[1];\n    return !(key in b && isDeepEqual(valA, b[key]));\n  });\n};\nvar findCommandIndex = function findCommandIndex(arr, command) {\n  var insets = ['insets', 'minimum_static_insets', 'maximum_static_insets', 'dynamic_insets'];\n  var index = -1;\n  if (command.type === 'character') {\n    index = arr.findIndex(function (c) {\n      return c.type === 'character' && c.character.id === command.character.id;\n    });\n  } else if (insets.includes(command.type)) {\n    index = arr.findIndex(function (c) {\n      return c.type === command.type;\n    });\n  } else if (command.type === 'app_context') {\n    index = arr.findIndex(function (c) {\n      return c.type === 'app_context';\n    });\n  } else {\n    index = arr.findIndex(function (c) {\n      return isDeepEqual(c, command);\n    });\n  }\n  return index;\n};\nvar appInitialData = function () {\n  var isPulled = false;\n  var pulled = [];\n  var committed = [];\n  var _diff = [];\n  var isCommandWasPulled = function isCommandWasPulled(command) {\n    return findCommandIndex(pulled, command) >= 0;\n  };\n  return {\n    /**\n     * Прочитать appInitialData. Запоминает состояние на момент прочтения\n     * @returns Массив комманд\n     */\n    pull: function pull() {\n      isPulled = true;\n      pulled = __spreadArray([], window.appInitialData || []);\n      return __spreadArray([], pulled);\n    },\n    /**\n     * Прочитать appInitialData\n     * @returns Массив комманд\n     */\n    get: function get() {\n      return __spreadArray([], window.appInitialData || []);\n    },\n    /**\n     * Зафиксировать текущее состояние appInitialData\n     */\n    commit: function commit() {\n      committed = __spreadArray([], window.appInitialData || []);\n      _diff = isPulled === true ? (window.appInitialData || []).filter(function (c) {\n        return !isCommandWasPulled(c);\n      }) : __spreadArray([], window.appInitialData || []);\n    },\n    /**\n     * Возвращает диф appInitialData между pull и commit\n     * @returns Массив комманд\n     */\n    diff: function diff() {\n      return __spreadArray([], _diff);\n    },\n    /**\n     * Возвращает флаг наличия command в appInitialData на момент commit\n     * @param command Команда, которую нужно проверить на наличие в appInitialData\n     * @returns true - если команда была в appInitialData\n     */\n    isCommitted: function isCommitted(command) {\n      var commandIndex = findCommandIndex(committed, command);\n      var isCommitted = commandIndex >= 0;\n      if (isCommitted) {\n        committed.splice(commandIndex, 1);\n      }\n      return isCommitted;\n    },\n    /**\n     * Возвращает первое сообщение из appInitialData, подходящее под фильтры param\n     * @param param Параметры: тип сообщения (например, smart_app_data)\n     * и тип команды (значение поля smart_app_data.type)\n     * @returns Первое сообщение, соответствующее параметрам или undefined\n     */\n    find: function find(_a) {\n      var type = _a.type,\n        command = _a.command;\n      var initialCommands = __spreadArray([], window.appInitialData || []);\n      var result = initialCommands.find(function (initialCommand) {\n        if (!command && type && type === initialCommand.type) {\n          return true;\n        }\n        var isCommandInSmartAppData = command && 'smart_app_data' in initialCommand;\n        if (!isCommandInSmartAppData) {\n          return;\n        }\n        if (command === initialCommand.smart_app_data.command || command === initialCommand.smart_app_data.type) {\n          return true;\n        }\n        return false;\n      });\n      return result && 'smart_app_data' in result ? result.smart_app_data : result;\n    }\n  };\n}();\nvar excludeTags = ['A', 'AUDIO', 'BUTTON', 'INPUT', 'OPTION', 'SELECT', 'TEXTAREA', 'VIDEO'];\nfunction inIframe() {\n  try {\n    return window.self !== window.parent;\n  } catch (e) {\n    return true;\n  }\n}\nif (/[a-zA-Z]/.test('1.32.0')) {\n  console.info('%cPlease use the latest version of SaluteJS Client. Your version is 1.32.0', 'color: yellow; font-size: 14px');\n}\nif (typeof window !== 'undefined' && inIframe()) {\n  var postMessage_1 = function postMessage_1(action) {\n    var _a;\n    (_a = window.parent) === null || _a === void 0 ? void 0 : _a.postMessage(JSON.stringify(action), '*');\n  };\n  var historyBack_1 = function historyBack_1() {\n    var prevPage = window.location.href;\n    window.history.back();\n    setTimeout(function () {\n      // закрываем страницу, если переход назад не поменял урл\n      if (window.location.href === prevPage) {\n        postMessage_1({\n          type: 'close'\n        });\n      }\n    }, 500);\n  };\n  window.appInitialData = [];\n  window.AssistantHost = {\n    sendDataContainer: function sendDataContainer(json) {\n      postMessage_1({\n        type: 'sendDataContainer',\n        payload: json\n      });\n    },\n    close: function close() {\n      postMessage_1({\n        type: 'close'\n      });\n    },\n    sendData: function sendData(json) {\n      postMessage_1({\n        type: 'sendData',\n        payload: json\n      });\n    },\n    setSuggests: function setSuggests(suggests) {\n      postMessage_1({\n        type: 'setSuggests',\n        payload: suggests\n      });\n    },\n    setHints: function setHints(hints) {\n      postMessage_1({\n        type: 'setHints',\n        payload: hints\n      });\n    },\n    ready: function ready() {\n      postMessage_1({\n        type: 'ready'\n      });\n    },\n    sendText: function sendText(message) {\n      postMessage_1({\n        type: 'sendText',\n        payload: message\n      });\n    },\n    setHeaderButtons: function setHeaderButtons(headerButtons) {\n      postMessage_1({\n        type: 'setHeaderButtons',\n        payload: JSON.stringify(headerButtons)\n      });\n    }\n  };\n  window.addEventListener('message', function (e) {\n    var _a, _b, _c, _d, _e, _f, _g, _h;\n    try {\n      if (typeof e.data === 'string') {\n        var data = JSON.parse(e.data);\n        switch (data.type) {\n          case 'onBack':\n            historyBack_1();\n            break;\n          case 'onData':\n            (_b = (_a = window.AssistantClient) === null || _a === void 0 ? void 0 : _a.onData) === null || _b === void 0 ? void 0 : _b.call(_a, data.payload);\n            break;\n          case 'onRequestState':\n            {\n              var state = (_d = (_c = window.AssistantClient) === null || _c === void 0 ? void 0 : _c.onRequestState) === null || _d === void 0 ? void 0 : _d.call(_c);\n              postMessage_1({\n                type: 'state',\n                payload: state,\n                requestId: data.requestId\n              });\n              break;\n            }\n          case 'onRequestRecoveryState':\n            {\n              var recoverystate = (_f = (_e = window.AssistantClient) === null || _e === void 0 ? void 0 : _e.onRequestRecoveryState) === null || _f === void 0 ? void 0 : _f.call(_e);\n              postMessage_1({\n                type: 'recoveryState',\n                payload: recoverystate\n              });\n              break;\n            }\n          case 'onStart':\n            (_h = (_g = window.AssistantClient) === null || _g === void 0 ? void 0 : _g.onStart) === null || _h === void 0 ? void 0 : _h.call(_g);\n            break;\n          default:\n            // eslint-disable-next-line no-console\n            console.error(e, 'Unknown parsed message');\n            break;\n        }\n      }\n    } catch (err) {\n      // eslint-disable-next-line no-console\n      console.error(err, 'Unknown message');\n    }\n  });\n  window.addEventListener('keydown', function (_a) {\n    var _b, _c;\n    var code = _a.code;\n    switch (code) {\n      case 'Enter':\n        if (document.activeElement && !excludeTags.includes(document.activeElement.tagName)) {\n          (_c = (_b = document.activeElement).click) === null || _c === void 0 ? void 0 : _c.call(_b);\n        }\n        break;\n      case 'Escape':\n        historyBack_1();\n        break;\n    }\n  });\n}\nvar createAssistant = function createAssistant(_a) {\n  var _b, _c;\n  var getState = _a.getState,\n    getRecoveryState = _a.getRecoveryState,\n    _d = _a.ready,\n    ready = _d === void 0 ? true : _d;\n  var _e = createNanoEvents(),\n    on = _e.on,\n    emitOriginal = _e.emit;\n  var _f = createNanoEvents(),\n    subscribeToCommand = _f.on,\n    emitAllCommands = _f.emit;\n  var observables = new Map();\n  var currentGetState = getState;\n  var currentGetRecoveryState = getRecoveryState;\n  var isInitialCommandsEmitted = false;\n  var readyRetries = 0;\n  var emitCommand = function emitCommand(command) {\n    if (command.type === 'smart_app_data') {\n      emitOriginal('command', command.smart_app_data);\n    }\n    if (command.type === 'smart_app_error') {\n      emitOriginal('error', command.smart_app_error);\n    }\n    return emitOriginal('data', command);\n  };\n  var cancelTts = typeof ((_b = window.AssistantHost) === null || _b === void 0 ? void 0 : _b.cancelTts) !== 'undefined' ? function () {\n    var _a, _b;\n    (_b = (_a = window.AssistantHost).cancelTts) === null || _b === void 0 ? void 0 : _b.call(_a, '');\n  } : undefined;\n  var emitAppInitialData = function emitAppInitialData() {\n    if (!isInitialCommandsEmitted) {\n      appInitialData.diff().forEach(function (c) {\n        return emitCommand(c);\n      });\n      isInitialCommandsEmitted = true;\n    }\n  };\n  var saveFirstSmartAppDataMid = function saveFirstSmartAppDataMid(mid) {\n    // eslint-disable-next-line no-underscore-dangle\n    if (typeof window.__ASSISTANT_CLIENT__.firstSmartAppDataMid === 'undefined') {\n      // eslint-disable-next-line no-underscore-dangle\n      window.__ASSISTANT_CLIENT__.firstSmartAppDataMid = mid;\n    }\n  };\n  window.AssistantClient = {\n    onData: function onData(command) {\n      var _a, _b, _c, _d, _e;\n      if (appInitialData.isCommitted(command)) {\n        return;\n      }\n      emitAllCommands(command.type, command);\n      if (command.type === 'smart_app_data' && (((_a = command.sdk_meta) === null || _a === void 0 ? void 0 : _a.mid) || '-1') !== '-1') {\n        saveFirstSmartAppDataMid((_b = command.sdk_meta) === null || _b === void 0 ? void 0 : _b.mid);\n      }\n      /// фильтр команды 'назад'\n      /// может приходить type='system', но в типах это не отражаем\n      // @ts-ignore\n      if (command.type === 'system' && ((_d = (_c = command.system) === null || _c === void 0 ? void 0 : _c.command) === null || _d === void 0 ? void 0 : _d.toUpperCase()) === 'BACK') {\n        return;\n      }\n      if (command.type === 'tts_state_update') {\n        emitOriginal('tts', {\n          state: command.state,\n          owner: command.owner\n        });\n      }\n      if ((command.type === 'smart_app_data' || command.type === 'smart_app_error') && ((_e = command.sdk_meta) === null || _e === void 0 ? void 0 : _e.requestId) && observables.has(command.sdk_meta.requestId)) {\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        var _f = command.sdk_meta;\n        _f.requestId;\n        var meta = __rest(_f, [\"requestId\"]);\n        var _g = observables.get(command.sdk_meta.requestId) || {},\n          requestId = _g.requestId,\n          next = _g.next;\n        if (Object.keys(meta).length > 0 || requestId) {\n          // eslint-disable-next-line camelcase\n          command.sdk_meta = __assign({}, meta);\n          if (requestId) {\n            // eslint-disable-next-line camelcase\n            command.sdk_meta = {\n              requestId: requestId\n            };\n          }\n        }\n        next === null || next === void 0 ? void 0 : next(command.type === 'smart_app_data' ? command : command);\n      }\n      emitCommand(command);\n    },\n    onRequestState: function onRequestState() {\n      return currentGetState();\n    },\n    onRequestRecoveryState: function onRequestRecoveryState() {\n      if (currentGetRecoveryState) {\n        return currentGetRecoveryState();\n      }\n      return undefined;\n    },\n    onStart: function onStart() {\n      emitOriginal('start');\n      emitAppInitialData();\n    }\n  };\n  var readyFn = function readyFn() {\n    return __awaiter(void 0, void 0, void 0, function () {\n      var firstSmartAppDataMid;\n      var _a, _b, _c;\n      return __generator(this, function (_d) {\n        readyRetries += 1;\n        if (typeof ((_a = window.AssistantHost) === null || _a === void 0 ? void 0 : _a.ready) !== 'function') {\n          return [2 /*return*/, new Promise(function (resolve, reject) {\n            var _a;\n            if (readyRetries > 3) {\n              throw new Error(\"window.AssistantHost is not ready. The ready method has the type \\\"\" + typeof ((_a = window.AssistantHost) === null || _a === void 0 ? void 0 : _a.ready) + \"\\\"\");\n            }\n            window.setTimeout(function () {\n              readyFn().then(resolve, reject);\n            }, 500);\n          })];\n        }\n        firstSmartAppDataMid = ((_c = (_b = appInitialData.get().find(function (c) {\n          var _a;\n          return c.type === 'smart_app_data' && (((_a = c.sdk_meta) === null || _a === void 0 ? void 0 : _a.mid) || '-1') !== '-1';\n          // @ts-ignore\n        })) === null || _b === void 0 ? void 0 : _b.sdk_meta) === null || _c === void 0 ? void 0 : _c.mid) || '-1';\n        if (firstSmartAppDataMid !== '-1') {\n          saveFirstSmartAppDataMid(firstSmartAppDataMid);\n        }\n        appInitialData.commit();\n        window.AssistantHost.ready();\n        return [2 /*return*/];\n      });\n    });\n  };\n\n  if (ready) {\n    window.setTimeout(readyFn); // таймаут для подписки на start\n  }\n\n  var sendData = function sendData(_a, onData) {\n    var _b, _c, _d;\n    var action = _a.action,\n      name = _a.name,\n      requestId = _a.requestId,\n      mode = _a.mode;\n    if ((_b = window.AssistantHost) === null || _b === void 0 ? void 0 : _b.sendDataContainer) {\n      if (onData == null) {\n        (_c = window.AssistantHost) === null || _c === void 0 ? void 0 : _c.sendDataContainer( /* eslint-disable-next-line camelcase */\n        JSON.stringify({\n          data: action,\n          message_name: name || '',\n          requestId: requestId,\n          mode: mode\n        }));\n        return function () {};\n      }\n      if (requestId && observables.has(requestId)) {\n        throw new Error('requestId должен быть уникальным');\n      }\n      var realRequestId_1 = requestId || v4();\n      var subscribe = createNanoObservable(function (_a) {\n        var _b;\n        var next = _a.next;\n        (_b = window.AssistantHost) === null || _b === void 0 ? void 0 : _b.sendDataContainer( /* eslint-disable-next-line camelcase */\n        JSON.stringify({\n          data: action,\n          message_name: name || '',\n          requestId: realRequestId_1,\n          mode: mode\n        }));\n        observables.set(realRequestId_1, {\n          next: next,\n          requestId: requestId\n        });\n      }).subscribe;\n      var unsubscribe_1 = subscribe({\n        next: onData\n      }).unsubscribe;\n      return function () {\n        unsubscribe_1();\n        observables.delete(realRequestId_1);\n      };\n    }\n    if (onData != null) {\n      throw new Error('Не поддерживается в данной версии клиента');\n    }\n    (_d = window.AssistantHost) === null || _d === void 0 ? void 0 : _d.sendData(JSON.stringify(action), name || null);\n    return function () {};\n  };\n  var sendAction = function sendAction(action, onData, onError, params) {\n    if (params === void 0) {\n      params = {};\n    }\n    return sendData(__assign(__assign({}, params), {\n      action: action\n    }), function (data) {\n      if (data.type === 'smart_app_data') {\n        onData === null || onData === void 0 ? void 0 : onData(data.smart_app_data);\n      }\n      if (data.type === 'smart_app_error') {\n        // @ts-ignore\n        onError === null || onError === void 0 ? void 0 : onError(data.smart_app_error);\n      }\n    });\n  };\n  return {\n    cancelTts: cancelTts,\n    close: function close() {\n      var _a;\n      return (_a = window.AssistantHost) === null || _a === void 0 ? void 0 : _a.close();\n    },\n    getGeo: typeof ((_c = window.AssistantHost) === null || _c === void 0 ? void 0 : _c.getGeo) !== 'undefined' ? function () {\n      var _a, _b;\n      (_b = (_a = window.AssistantHost).getGeo) === null || _b === void 0 ? void 0 : _b.call(_a);\n    } : undefined,\n    getInitialData: appInitialData.pull,\n    findInInitialData: appInitialData.find,\n    getRecoveryState: function getRecoveryState() {\n      return window.appRecoveryState;\n    },\n    on: on,\n    subscribeToCommand: subscribeToCommand,\n    sendAction: sendAction,\n    sendData: sendData,\n    sendActionPromisified: function sendActionPromisified(action, params) {\n      if (params === void 0) {\n        params = {};\n      }\n      return new Promise(function (resolve, reject) {\n        var off = sendAction(action, function () {\n          var args = [];\n          for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n          }\n          off();\n          resolve.apply(void 0, args);\n        }, function () {\n          var args = [];\n          for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n          }\n          off();\n          reject.apply(void 0, args);\n        }, params);\n      });\n    },\n    sendDataPromisified: function sendDataPromisified(params) {\n      return new Promise(function (resolve) {\n        var off = sendData(params, function () {\n          var args = [];\n          for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n          }\n          off();\n          resolve.apply(void 0, args);\n        });\n      });\n    },\n    setGetState: function setGetState(nextGetState) {\n      currentGetState = nextGetState;\n    },\n    setGetRecoveryState: function setGetRecoveryState(nextGetRecoveryState) {\n      currentGetRecoveryState = nextGetRecoveryState;\n    },\n    setSuggests: function setSuggests(suggestions) {\n      var _a;\n      (_a = window.AssistantHost) === null || _a === void 0 ? void 0 : _a.setSuggests(JSON.stringify({\n        suggestions: {\n          buttons: suggestions\n        }\n      }));\n    },\n    setHints: function setHints(hints) {\n      var _a;\n      (_a = window.AssistantHost) === null || _a === void 0 ? void 0 : _a.setHints(JSON.stringify({\n        hints: hints\n      }));\n    },\n    sendText: function sendText(message) {\n      var _a;\n      return (_a = window.AssistantHost) === null || _a === void 0 ? void 0 : _a.sendText(message);\n    },\n    setHeaderButtons: function setHeaderButtons(headerButtons) {\n      var _a, _b;\n      if (!((_a = window.AssistantHost) === null || _a === void 0 ? void 0 : _a.setHeaderButtons)) {\n        throw new Error('setHeaderButtons не поддерживается в данной версии клиента');\n      }\n      (_b = window.AssistantHost) === null || _b === void 0 ? void 0 : _b.setHeaderButtons(headerButtons);\n    },\n    ready: readyFn\n  };\n};\nif (typeof window !== 'undefined') {\n  // eslint-disable-next-line no-underscore-dangle\n  window.__ASSISTANT_CLIENT__ = {\n    version: '1.32.0'\n  };\n}\nexport { createAssistant };","map":{"version":3,"names":["e","__spreadArray","a","__rest","_","__assign","b","__awaiter","f","createNanoObservable","d","createNanoEvents","c","__generator","getRandomValues","rnds8","Uint8Array","rng","crypto","bind","msCrypto","Error","REGEX","validate","uuid","test","byteToHex","i","push","toString","substr","stringify","arr","offset","arguments","length","undefined","toLowerCase","TypeError","v4","options","buf","rnds","random","isDeepEqual","Array","isArray","some","valA","key","entriesA","Object","entries","entriesB","_a","findCommandIndex","command","insets","index","type","findIndex","character","id","includes","appInitialData","isPulled","pulled","committed","diff","isCommandWasPulled","pull","window","get","commit","filter","isCommitted","commandIndex","splice","find","initialCommands","result","initialCommand","isCommandInSmartAppData","smart_app_data","excludeTags","inIframe","self","parent","console","info","postMessage_1","action","postMessage","JSON","historyBack_1","prevPage","location","href","history","back","setTimeout","AssistantHost","sendDataContainer","json","payload","close","sendData","setSuggests","suggests","setHints","hints","ready","sendText","message","setHeaderButtons","headerButtons","addEventListener","_b","_c","_d","_e","_f","_g","_h","data","parse","AssistantClient","onData","call","state","onRequestState","requestId","recoverystate","onRequestRecoveryState","onStart","error","err","code","document","activeElement","tagName","click","createAssistant","getState","getRecoveryState","on","emitOriginal","emit","subscribeToCommand","emitAllCommands","observables","Map","currentGetState","currentGetRecoveryState","isInitialCommandsEmitted","readyRetries","emitCommand","smart_app_error","cancelTts","emitAppInitialData","forEach","saveFirstSmartAppDataMid","mid","__ASSISTANT_CLIENT__","firstSmartAppDataMid","sdk_meta","system","toUpperCase","owner","has","meta","next","keys","readyFn","Promise","resolve","reject","then","name","mode","message_name","realRequestId_1","subscribe","set","unsubscribe_1","unsubscribe","delete","sendAction","onError","params","getGeo","getInitialData","findInInitialData","appRecoveryState","sendActionPromisified","off","args","_i","apply","sendDataPromisified","setGetState","nextGetState","setGetRecoveryState","nextGetRecoveryState","suggestions","buttons","version"],"sources":["/Users/egor/Documents/GitHub/SBERProject/node_modules/@salutejs/client/esm/createAssistant.js"],"sourcesContent":["import { e as __spreadArray, a as __rest, _ as __assign, b as __awaiter, f as createNanoObservable, d as createNanoEvents, c as __generator } from './common-ba25e019.js';\n\n// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\nvar getRandomValues;\nvar rnds8 = new Uint8Array(16);\nfunction rng() {\n  // lazy load so that environments that need to polyfill have a chance to do so\n  if (!getRandomValues) {\n    // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation. Also,\n    // find the complete implementation of crypto (msCrypto) on IE11.\n    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto) || typeof msCrypto !== 'undefined' && typeof msCrypto.getRandomValues === 'function' && msCrypto.getRandomValues.bind(msCrypto);\n\n    if (!getRandomValues) {\n      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n    }\n  }\n\n  return getRandomValues(rnds8);\n}\n\nvar REGEX = /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;\n\nfunction validate(uuid) {\n  return typeof uuid === 'string' && REGEX.test(uuid);\n}\n\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nvar byteToHex = [];\n\nfor (var i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).substr(1));\n}\n\nfunction stringify(arr) {\n  var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  var uuid = (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase(); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!validate(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\nfunction v4(options, buf, offset) {\n  options = options || {};\n  var rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (var i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return stringify(rnds);\n}\n\nvar isDeepEqual = function (a, b) {\n    // Простое значение\n    if (typeof a !== 'object' || a === null) {\n        return a === b;\n    }\n    // Массив\n    if (Array.isArray(a)) {\n        if (!Array.isArray(b) || a.length !== b.length) {\n            return false;\n        }\n        return !a.some(function (valA, key) { return !isDeepEqual(valA, b[key]); });\n    }\n    // Словарь\n    if (typeof b !== 'object' || b === null) {\n        return false;\n    }\n    var entriesA = Object.entries(a);\n    var entriesB = Object.entries(b);\n    if (entriesA.length !== entriesB.length) {\n        return false;\n    }\n    return !entriesA.some(function (_a) {\n        var key = _a[0], valA = _a[1];\n        return !(key in b && isDeepEqual(valA, b[key]));\n    });\n};\nvar findCommandIndex = function (arr, command) {\n    var insets = ['insets', 'minimum_static_insets', 'maximum_static_insets', 'dynamic_insets'];\n    var index = -1;\n    if (command.type === 'character') {\n        index = arr.findIndex(function (c) { return c.type === 'character' && c.character.id === command.character.id; });\n    }\n    else if (insets.includes(command.type)) {\n        index = arr.findIndex(function (c) { return c.type === command.type; });\n    }\n    else if (command.type === 'app_context') {\n        index = arr.findIndex(function (c) { return c.type === 'app_context'; });\n    }\n    else {\n        index = arr.findIndex(function (c) { return isDeepEqual(c, command); });\n    }\n    return index;\n};\nvar appInitialData = (function () {\n    var isPulled = false;\n    var pulled = [];\n    var committed = [];\n    var diff = [];\n    var isCommandWasPulled = function (command) { return findCommandIndex(pulled, command) >= 0; };\n    return {\n        /**\n         * Прочитать appInitialData. Запоминает состояние на момент прочтения\n         * @returns Массив комманд\n         */\n        pull: function () {\n            isPulled = true;\n            pulled = __spreadArray([], (window.appInitialData || []));\n            return __spreadArray([], pulled);\n        },\n        /**\n         * Прочитать appInitialData\n         * @returns Массив комманд\n         */\n        get: function () { return __spreadArray([], (window.appInitialData || [])); },\n        /**\n         * Зафиксировать текущее состояние appInitialData\n         */\n        commit: function () {\n            committed = __spreadArray([], (window.appInitialData || []));\n            diff =\n                isPulled === true\n                    ? (window.appInitialData || []).filter(function (c) { return !isCommandWasPulled(c); })\n                    : __spreadArray([], (window.appInitialData || []));\n        },\n        /**\n         * Возвращает диф appInitialData между pull и commit\n         * @returns Массив комманд\n         */\n        diff: function () {\n            return __spreadArray([], diff);\n        },\n        /**\n         * Возвращает флаг наличия command в appInitialData на момент commit\n         * @param command Команда, которую нужно проверить на наличие в appInitialData\n         * @returns true - если команда была в appInitialData\n         */\n        isCommitted: function (command) {\n            var commandIndex = findCommandIndex(committed, command);\n            var isCommitted = commandIndex >= 0;\n            if (isCommitted) {\n                committed.splice(commandIndex, 1);\n            }\n            return isCommitted;\n        },\n        /**\n         * Возвращает первое сообщение из appInitialData, подходящее под фильтры param\n         * @param param Параметры: тип сообщения (например, smart_app_data)\n         * и тип команды (значение поля smart_app_data.type)\n         * @returns Первое сообщение, соответствующее параметрам или undefined\n         */\n        find: function (_a) {\n            var type = _a.type, command = _a.command;\n            var initialCommands = __spreadArray([], (window.appInitialData || []));\n            var result = initialCommands.find(function (initialCommand) {\n                if (!command && type && type === initialCommand.type) {\n                    return true;\n                }\n                var isCommandInSmartAppData = command && 'smart_app_data' in initialCommand;\n                if (!isCommandInSmartAppData) {\n                    return;\n                }\n                if (command === initialCommand.smart_app_data.command ||\n                    command === initialCommand.smart_app_data.type) {\n                    return true;\n                }\n                return false;\n            });\n            return (result && 'smart_app_data' in result ? result.smart_app_data : result);\n        },\n    };\n})();\n\nvar excludeTags = ['A', 'AUDIO', 'BUTTON', 'INPUT', 'OPTION', 'SELECT', 'TEXTAREA', 'VIDEO'];\nfunction inIframe() {\n    try {\n        return window.self !== window.parent;\n    }\n    catch (e) {\n        return true;\n    }\n}\nif (/[a-zA-Z]/.test('1.32.0')) {\n    console.info('%cPlease use the latest version of SaluteJS Client. Your version is 1.32.0', 'color: yellow; font-size: 14px');\n}\nif (typeof window !== 'undefined' && inIframe()) {\n    var postMessage_1 = function (action) {\n        var _a;\n        (_a = window.parent) === null || _a === void 0 ? void 0 : _a.postMessage(JSON.stringify(action), '*');\n    };\n    var historyBack_1 = function () {\n        var prevPage = window.location.href;\n        window.history.back();\n        setTimeout(function () {\n            // закрываем страницу, если переход назад не поменял урл\n            if (window.location.href === prevPage) {\n                postMessage_1({ type: 'close' });\n            }\n        }, 500);\n    };\n    window.appInitialData = [];\n    window.AssistantHost = {\n        sendDataContainer: function (json) {\n            postMessage_1({ type: 'sendDataContainer', payload: json });\n        },\n        close: function () {\n            postMessage_1({ type: 'close' });\n        },\n        sendData: function (json) {\n            postMessage_1({ type: 'sendData', payload: json });\n        },\n        setSuggests: function (suggests) {\n            postMessage_1({ type: 'setSuggests', payload: suggests });\n        },\n        setHints: function (hints) {\n            postMessage_1({ type: 'setHints', payload: hints });\n        },\n        ready: function () {\n            postMessage_1({ type: 'ready' });\n        },\n        sendText: function (message) {\n            postMessage_1({ type: 'sendText', payload: message });\n        },\n        setHeaderButtons: function (headerButtons) {\n            postMessage_1({ type: 'setHeaderButtons', payload: JSON.stringify(headerButtons) });\n        },\n    };\n    window.addEventListener('message', function (e) {\n        var _a, _b, _c, _d, _e, _f, _g, _h;\n        try {\n            if (typeof e.data === 'string') {\n                var data = JSON.parse(e.data);\n                switch (data.type) {\n                    case 'onBack':\n                        historyBack_1();\n                        break;\n                    case 'onData':\n                        (_b = (_a = window.AssistantClient) === null || _a === void 0 ? void 0 : _a.onData) === null || _b === void 0 ? void 0 : _b.call(_a, data.payload);\n                        break;\n                    case 'onRequestState': {\n                        var state = (_d = (_c = window.AssistantClient) === null || _c === void 0 ? void 0 : _c.onRequestState) === null || _d === void 0 ? void 0 : _d.call(_c);\n                        postMessage_1({ type: 'state', payload: state, requestId: data.requestId });\n                        break;\n                    }\n                    case 'onRequestRecoveryState': {\n                        var recoverystate = (_f = (_e = window.AssistantClient) === null || _e === void 0 ? void 0 : _e.onRequestRecoveryState) === null || _f === void 0 ? void 0 : _f.call(_e);\n                        postMessage_1({ type: 'recoveryState', payload: recoverystate });\n                        break;\n                    }\n                    case 'onStart':\n                        (_h = (_g = window.AssistantClient) === null || _g === void 0 ? void 0 : _g.onStart) === null || _h === void 0 ? void 0 : _h.call(_g);\n                        break;\n                    default:\n                        // eslint-disable-next-line no-console\n                        console.error(e, 'Unknown parsed message');\n                        break;\n                }\n            }\n        }\n        catch (err) {\n            // eslint-disable-next-line no-console\n            console.error(err, 'Unknown message');\n        }\n    });\n    window.addEventListener('keydown', function (_a) {\n        var _b, _c;\n        var code = _a.code;\n        switch (code) {\n            case 'Enter':\n                if (document.activeElement && !excludeTags.includes(document.activeElement.tagName)) {\n                    (_c = (_b = document.activeElement).click) === null || _c === void 0 ? void 0 : _c.call(_b);\n                }\n                break;\n            case 'Escape':\n                historyBack_1();\n                break;\n        }\n    });\n}\nvar createAssistant = function (_a) {\n    var _b, _c;\n    var getState = _a.getState, getRecoveryState = _a.getRecoveryState, _d = _a.ready, ready = _d === void 0 ? true : _d;\n    var _e = createNanoEvents(), on = _e.on, emitOriginal = _e.emit;\n    var _f = createNanoEvents(), subscribeToCommand = _f.on, emitAllCommands = _f.emit;\n    var observables = new Map();\n    var currentGetState = getState;\n    var currentGetRecoveryState = getRecoveryState;\n    var isInitialCommandsEmitted = false;\n    var readyRetries = 0;\n    var emitCommand = function (command) {\n        if (command.type === 'smart_app_data') {\n            emitOriginal('command', command.smart_app_data);\n        }\n        if (command.type === 'smart_app_error') {\n            emitOriginal('error', command.smart_app_error);\n        }\n        return emitOriginal('data', command);\n    };\n    var cancelTts = typeof ((_b = window.AssistantHost) === null || _b === void 0 ? void 0 : _b.cancelTts) !== 'undefined'\n        ? function () {\n            var _a, _b;\n            (_b = (_a = window.AssistantHost).cancelTts) === null || _b === void 0 ? void 0 : _b.call(_a, '');\n        }\n        : undefined;\n    var emitAppInitialData = function () {\n        if (!isInitialCommandsEmitted) {\n            appInitialData.diff().forEach(function (c) { return emitCommand(c); });\n            isInitialCommandsEmitted = true;\n        }\n    };\n    var saveFirstSmartAppDataMid = function (mid) {\n        // eslint-disable-next-line no-underscore-dangle\n        if (typeof window.__ASSISTANT_CLIENT__.firstSmartAppDataMid === 'undefined') {\n            // eslint-disable-next-line no-underscore-dangle\n            window.__ASSISTANT_CLIENT__.firstSmartAppDataMid = mid;\n        }\n    };\n    window.AssistantClient = {\n        onData: function (command) {\n            var _a, _b, _c, _d, _e;\n            if (appInitialData.isCommitted(command)) {\n                return;\n            }\n            emitAllCommands(command.type, command);\n            if (command.type === 'smart_app_data' && (((_a = command.sdk_meta) === null || _a === void 0 ? void 0 : _a.mid) || '-1') !== '-1') {\n                saveFirstSmartAppDataMid((_b = command.sdk_meta) === null || _b === void 0 ? void 0 : _b.mid);\n            }\n            /// фильтр команды 'назад'\n            /// может приходить type='system', но в типах это не отражаем\n            // @ts-ignore\n            if (command.type === 'system' && ((_d = (_c = command.system) === null || _c === void 0 ? void 0 : _c.command) === null || _d === void 0 ? void 0 : _d.toUpperCase()) === 'BACK') {\n                return;\n            }\n            if (command.type === 'tts_state_update') {\n                emitOriginal('tts', {\n                    state: command.state,\n                    owner: command.owner,\n                });\n            }\n            if ((command.type === 'smart_app_data' || command.type === 'smart_app_error') &&\n                ((_e = command.sdk_meta) === null || _e === void 0 ? void 0 : _e.requestId) &&\n                observables.has(command.sdk_meta.requestId)) {\n                // eslint-disable-next-line @typescript-eslint/no-unused-vars\n                var _f = command.sdk_meta; _f.requestId; var meta = __rest(_f, [\"requestId\"]);\n                var _g = observables.get(command.sdk_meta.requestId) || {}, requestId = _g.requestId, next = _g.next;\n                if (Object.keys(meta).length > 0 || requestId) {\n                    // eslint-disable-next-line camelcase\n                    command.sdk_meta = __assign({}, meta);\n                    if (requestId) {\n                        // eslint-disable-next-line camelcase\n                        command.sdk_meta = { requestId: requestId };\n                    }\n                }\n                next === null || next === void 0 ? void 0 : next(command.type === 'smart_app_data' ? command : command);\n            }\n            emitCommand(command);\n        },\n        onRequestState: function () {\n            return currentGetState();\n        },\n        onRequestRecoveryState: function () {\n            if (currentGetRecoveryState) {\n                return currentGetRecoveryState();\n            }\n            return undefined;\n        },\n        onStart: function () {\n            emitOriginal('start');\n            emitAppInitialData();\n        },\n    };\n    var readyFn = function () { return __awaiter(void 0, void 0, void 0, function () {\n        var firstSmartAppDataMid;\n        var _a, _b, _c;\n        return __generator(this, function (_d) {\n            readyRetries += 1;\n            if (typeof ((_a = window.AssistantHost) === null || _a === void 0 ? void 0 : _a.ready) !== 'function') {\n                return [2 /*return*/, new Promise(function (resolve, reject) {\n                        var _a;\n                        if (readyRetries > 3) {\n                            throw new Error(\"window.AssistantHost is not ready. The ready method has the type \\\"\" + typeof ((_a = window.AssistantHost) === null || _a === void 0 ? void 0 : _a.ready) + \"\\\"\");\n                        }\n                        window.setTimeout(function () {\n                            readyFn().then(resolve, reject);\n                        }, 500);\n                    })];\n            }\n            firstSmartAppDataMid = ((_c = (_b = appInitialData.get().find(function (c) {\n                var _a;\n                return c.type === 'smart_app_data' && (((_a = c.sdk_meta) === null || _a === void 0 ? void 0 : _a.mid) || '-1') !== '-1';\n                // @ts-ignore\n            })) === null || _b === void 0 ? void 0 : _b.sdk_meta) === null || _c === void 0 ? void 0 : _c.mid) || '-1';\n            if (firstSmartAppDataMid !== '-1') {\n                saveFirstSmartAppDataMid(firstSmartAppDataMid);\n            }\n            appInitialData.commit();\n            window.AssistantHost.ready();\n            return [2 /*return*/];\n        });\n    }); };\n    if (ready) {\n        window.setTimeout(readyFn); // таймаут для подписки на start\n    }\n    var sendData = function (_a, onData) {\n        var _b, _c, _d;\n        var action = _a.action, name = _a.name, requestId = _a.requestId, mode = _a.mode;\n        if ((_b = window.AssistantHost) === null || _b === void 0 ? void 0 : _b.sendDataContainer) {\n            if (onData == null) {\n                (_c = window.AssistantHost) === null || _c === void 0 ? void 0 : _c.sendDataContainer(\n                /* eslint-disable-next-line camelcase */\n                JSON.stringify({ data: action, message_name: name || '', requestId: requestId, mode: mode }));\n                return function () { };\n            }\n            if (requestId && observables.has(requestId)) {\n                throw new Error('requestId должен быть уникальным');\n            }\n            var realRequestId_1 = requestId || v4();\n            var subscribe = createNanoObservable(function (_a) {\n                var _b;\n                var next = _a.next;\n                (_b = window.AssistantHost) === null || _b === void 0 ? void 0 : _b.sendDataContainer(\n                /* eslint-disable-next-line camelcase */\n                JSON.stringify({ data: action, message_name: name || '', requestId: realRequestId_1, mode: mode }));\n                observables.set(realRequestId_1, { next: next, requestId: requestId });\n            }).subscribe;\n            var unsubscribe_1 = subscribe({ next: onData }).unsubscribe;\n            return function () {\n                unsubscribe_1();\n                observables.delete(realRequestId_1);\n            };\n        }\n        if (onData != null) {\n            throw new Error('Не поддерживается в данной версии клиента');\n        }\n        (_d = window.AssistantHost) === null || _d === void 0 ? void 0 : _d.sendData(JSON.stringify(action), name || null);\n        return function () { };\n    };\n    var sendAction = function (action, onData, onError, params) {\n        if (params === void 0) { params = {}; }\n        return sendData(__assign(__assign({}, params), { action: action }), function (data) {\n            if (data.type === 'smart_app_data') {\n                onData === null || onData === void 0 ? void 0 : onData(data.smart_app_data);\n            }\n            if (data.type === 'smart_app_error') {\n                // @ts-ignore\n                onError === null || onError === void 0 ? void 0 : onError(data.smart_app_error);\n            }\n        });\n    };\n    return {\n        cancelTts: cancelTts,\n        close: function () { var _a; return (_a = window.AssistantHost) === null || _a === void 0 ? void 0 : _a.close(); },\n        getGeo: typeof ((_c = window.AssistantHost) === null || _c === void 0 ? void 0 : _c.getGeo) !== 'undefined'\n            ? function () {\n                var _a, _b;\n                (_b = (_a = window.AssistantHost).getGeo) === null || _b === void 0 ? void 0 : _b.call(_a);\n            }\n            : undefined,\n        getInitialData: appInitialData.pull,\n        findInInitialData: appInitialData.find,\n        getRecoveryState: function () { return window.appRecoveryState; },\n        on: on,\n        subscribeToCommand: subscribeToCommand,\n        sendAction: sendAction,\n        sendData: sendData,\n        sendActionPromisified: function (action, params) {\n            if (params === void 0) { params = {}; }\n            return new Promise(function (resolve, reject) {\n                var off = sendAction(action, function () {\n                    var args = [];\n                    for (var _i = 0; _i < arguments.length; _i++) {\n                        args[_i] = arguments[_i];\n                    }\n                    off();\n                    resolve.apply(void 0, args);\n                }, function () {\n                    var args = [];\n                    for (var _i = 0; _i < arguments.length; _i++) {\n                        args[_i] = arguments[_i];\n                    }\n                    off();\n                    reject.apply(void 0, args);\n                }, params);\n            });\n        },\n        sendDataPromisified: function (params) {\n            return new Promise(function (resolve) {\n                var off = sendData(params, function () {\n                    var args = [];\n                    for (var _i = 0; _i < arguments.length; _i++) {\n                        args[_i] = arguments[_i];\n                    }\n                    off();\n                    resolve.apply(void 0, args);\n                });\n            });\n        },\n        setGetState: function (nextGetState) {\n            currentGetState = nextGetState;\n        },\n        setGetRecoveryState: function (nextGetRecoveryState) {\n            currentGetRecoveryState = nextGetRecoveryState;\n        },\n        setSuggests: function (suggestions) {\n            var _a;\n            (_a = window.AssistantHost) === null || _a === void 0 ? void 0 : _a.setSuggests(JSON.stringify({ suggestions: { buttons: suggestions } }));\n        },\n        setHints: function (hints) {\n            var _a;\n            (_a = window.AssistantHost) === null || _a === void 0 ? void 0 : _a.setHints(JSON.stringify({ hints: hints }));\n        },\n        sendText: function (message) { var _a; return (_a = window.AssistantHost) === null || _a === void 0 ? void 0 : _a.sendText(message); },\n        setHeaderButtons: function (headerButtons) {\n            var _a, _b;\n            if (!((_a = window.AssistantHost) === null || _a === void 0 ? void 0 : _a.setHeaderButtons)) {\n                throw new Error('setHeaderButtons не поддерживается в данной версии клиента');\n            }\n            (_b = window.AssistantHost) === null || _b === void 0 ? void 0 : _b.setHeaderButtons(headerButtons);\n        },\n        ready: readyFn,\n    };\n};\nif (typeof window !== 'undefined') {\n    // eslint-disable-next-line no-underscore-dangle\n    window.__ASSISTANT_CLIENT__ = { version: '1.32.0' };\n}\n\nexport { createAssistant };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}